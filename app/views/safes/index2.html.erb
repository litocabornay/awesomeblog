<% provide(:title,"在庫") %>

<div class="row">
<div class="container-fluid" style="margin-right: 20px; margin-left: 20px;">  
<h3>在庫</h3>
<h4>本体(全揃い)</h4>

<style>

#myImg {
    border-radius: 5px;
    cursor: pointer;
    transition: 0.3s;
}

#myImg:hover {opacity: 0.7;}

/* The Modal (background) */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    padding-top: 100px; /* Location of the box */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgb(0,0,0); /* Fallback color */
    background-color: rgba(0,0,0,0.9); /* Black w/ opacity */
}

/* Modal Content (image) */
.modal-content {
    margin: auto;
    display: block;
    width: 80%;
    max-width: 700px;
}

/* Caption of Modal Image */
#caption {
    margin: auto;
    display: block;
    width: 80%;
    max-width: 700px;
    text-align: center;
    color: #ccc;
    padding: 10px 0;
    height: 150px;
}

/* Add Animation */
.modal-content, #caption {    
    -webkit-animation-name: zoom;
    -webkit-animation-duration: 0.6s;
    animation-name: zoom;
    animation-duration: 0.6s;
}

@-webkit-keyframes zoom {
    from {-webkit-transform:scale(0)} 
    to {-webkit-transform:scale(1)}
}

@keyframes zoom {
    from {transform:scale(0)} 
    to {transform:scale(1)}
}

/* The Close Button */
.close {
    position: absolute;
    top: 15px;
    right: 35px;
    color: #f1f1f1;
    font-size: 40px;
    font-weight: bold;
    transition: 0.3s;
}

.close:hover,
.close:focus {
    color: #bbb;
    text-decoration: none;
    cursor: pointer;
}

/* 100% Image Width on Smaller Screens */
@media only screen and (max-width: 700px){
    .modal-content {
        width: 100%;
    }
}

</style>

<div class="btn-group" >
<a href="/zaiko" class="btn btn-default"><i class="fa fa-bars"></i> 本体(全揃い)</a>
<a href="/zaiko-cell" class="btn btn-default"><i class="fa fa-bolt"></i> セルのみ</a>
<a href="/zaiko-flame" class="btn btn-default"><i class="fa fa-clone"></i> 枠のみ</a>
<a href="/zaiko-foundation" class="btn btn-default"><i class="fa fa-cubes"></i> 基盤のみ</a>
<a href="/zaiko-slot" class="btn btn-default"><i class="fa fa-plus"></i> スロット</a>
</div>


<div class="btn-group float-right">

<a href="?t=c" class="btn btn-default"><i class="fa fa-eye-slash"></i> Compact View</a>
<a href="?t=f" class="btn btn-default"><i class="fa fa-eye"></i> Full View</a>

<%= link_to "CSV出力",csv_output_two_safes_path(format: :csv), :class => "btn btn-danger" %>

</div>

<table class="table table-bordered table-hover" style="margin-top: 30px;">
  <thead class="thead-default">

<% if (params[:t] == "f") %>
<table class="table table-bordered table-hover table-condensed" style="margin-top: 30px; font-size:70%;">
  <thead class="thead-default">
<% end %>

    <tr scope="row">
     
      <th class="col-md-1">ID</th>    
      <th class="col-md-2">メーカー</th>

      <th class="col-md-3">機種名</th>


      <th class="col-md-1">仕入価格</th>
      <th class="col-md-1">倉庫</th>

      <% if (params[:t] == "f") %>
      <th class="col-md-3">機器番号</th>
      <th class="col-md-1">入庫先</th>
      <th class="col-md-1" style="font-size: 90%;">入庫担当者<%#= sortable "confirm_price", "確定価格(全込)" %></th>
      <th class="col-md-1">撤去日</th>
      <th class="col-md-1">検定日</th>    
      <th class="col-md-1">パネル色</th>
      <th class="col-md-1">備考</th>
      <th class="col-md-1">画像</th>
      
      <% end %>
      
      <th class="col-md-1 text-center">編集</th>
      <th class="col-md-1 text-center">出庫</th>

      <% if (params[:t] == "f") %>
      <th class="col-md-1 text-center">p-sensor</th>
      <th class="col-md-1 text-center">削除</th>
      <% end %>
      
    </tr>
  </thead>
<tbody>

<% @safes.each do |safe| %>

   
      <tr scope="row">

        <td><%= safe.id %></td>
        <td><%= safe.maker %></td>        
        <td><%= safe.name %></td>
      
       <% if (params[:t] == "f") %>
        <% unless safe.price_from.blank? %>
        <td><%= safe.price_from.to_s(:delimited) %> 円</td>
        <% else %>
        <td><%= safe.price_from %> 円</td>
        <% end %>
       <% end %>

       <% if (params[:t] == "f") %>
       <td><%= safe.place %></td>
       <% end %>

      <% if (params[:t] == "f") %>
        <td>
         セル：<%= safe.number %><br>
         枠　：<%= safe.number_of_frame %><br>
         基盤：<%= safe.number_of_foundation %>
        </td>
      <% end %>


      <% if (params[:t] == "f") %>
        <td>
       <%= safe.created_at.strftime("%m/%d") %> <%= safe.from %>
        </td>
      <% end %>
      
      <% if (params[:t] == "f") %>
        <td>
       <%= safe.staff %> <br>
      </td>
      <% end %>

      <% if !(params[:t] == "f") %>
      <% unless safe.price_from.blank? %>
        <td><%= safe.price_from.to_s(:delimited) %> 円</td>
        <% else %>
        <td><%= safe.price_from %> 円</td>
        <% end %>
       <% end %>
      
        
      <% if (params[:t] == "f") %>
        <td><%= safe.date_of_removal %></td>
        <td><%= safe.date_of_verification %></td>
      <% end %>
      
      <% if !(params[:t] == "f") %>
        <td><%= safe.place %></td>
      <% end %>

      <% if (params[:t] == "f") %>
        <td><%= safe.color_of_panel %></td>
        <td><%= safe.remarks %></td>
        <td class="text-center"><a href="<%= safe.photo %>" target="_blank"><img src="<%= safe.photo %>" width="40px"></a></td>
      <% end %>
      
      
        <td class="text-center">
        <%= link_to edit2_safes_path(safe), :class => "btn btn-primary" do %>
        <i class="fa fa-pencil-square-o"></i>
        <% end %>
        </td>
        
        
      <% if safe.status == "出庫済" %>
       <td>出庫済</td>
      <% else %>
      
       <td class="text-center">
        <%= link_to edit_safe_path(safe, params: { safe: { status: "出庫済"} } ), :class => "btn btn-primary" do %>
        <i class="fa fa-sign-out"></i>
        <% end %>
       </td>
       
       
       
      <% end %> 
      
       <% if (params[:t] == "f") %>
       <td class="text-center">
        <% @utf81 = safe.name.encode(Encoding::SJIS, :invalid => :replace, :undef => :replace) %>
        <% @utf8 = ERB::Util.url_encode(@utf81) %>
        <% @url = "https://www.p-sensor.co.jp/php/search_sale.php?&item=" + @utf8 %>
        <%= link_to "P", @url, :class => "btn btn-primary" %>
       </td>
       <% end %>

       <% if (params[:t] == "f") %>
       <td class="text-center">
      <%= link_to  safe ,method: :delete, data: { confirm: "本当にこの在庫データを削除しますか？" }, :class => "btn btn-primary" do %>
        <i class="fa fa-trash-o"></i>
        <% end %>
       </td>



       <% end %>
 
      </tr>


<% end %>
</tbody>
</table>

</div>
</div>
</div>


<!-- The Modal -->
<div id="myModal" class="modal">
  <span class="close">&times;</span>
  <img class="modal-content" id="img01">
  <div id="caption"></div>
</div>

<script>
// Get the modal


var modal = document.getElementById('myModal');

// Get the image and insert it inside the modal - use its "alt" text as a caption
var img = document.getElementsByClassName('aaa');
var modalImg = document.getElementById("img01");
var captionText = document.getElementById("caption");
img.onclick = function(){
    modal.style.display = "block";
    modalImg.src = this.src;
    captionText.innerHTML = this.alt;
}

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks on <span> (x), close the modal
span.onclick = function() { 
    modal.style.display = "none";
}
</script>

<%= paginate @safes %>


</div>
</div>